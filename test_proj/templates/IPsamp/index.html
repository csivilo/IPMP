<!DOCTYPE HTML>
{% load staticfiles %}
<html>
    <title>IPMP</title>
    <head>
    <link rel="stylesheet" href="{%  static "js/webix/codebase/webix.css" %}" type="text/css">
    <script src="{%  static "js/webix/codebase/webix.js" %}" type="text/javascript"></script>
    <script src="{%  static "js/jquery-3.0.0.js" %}" type="text/javascript"></script>
    </head>
    
    <body>
    <script type="text/javascript" charset="utf-8">

       var data_out = 0.; //this is a placeholder variable that will hold y that was passed in from django

        webix.ui({
            rows:[
               {view: "toolbar", id:"toolbar", elements:[
               {view:"button", value:"File", width:80 /*, click:file_options*/},
               {view:"button", value:"Disclaimer", width:80 /* ,click:ipmp_disclaim*/},
               {view:"button", value:"Help", width:80 /* ,click:ipmp_help}*/},
                ]
                },
                {cols:[
               {rows:[
                   {view: "datatable",
                   id: "input_table",
                   columns: [
                       {id: "time_input", editor: "text", header: "Time", width: 100},
                       {id: "conc_input", editor: "text", header: "Conc.", width: 100}],
                   editable: true,
                   height:250,
                   width:200,
                   data:[
                        { id: 1, time_input: 0, conc_input:0},
                        { id: 2, time_input: 0, conc_input:0},
                        { id: 3, time_input: 0, conc_input:0},
                        { id: 4, time_input: 0, conc_input:0},
                        { id: 5, time_input: 0, conc_input:0},
                        { id: 6, time_input: 0, conc_input:0},
                        { id: 7, time_input: 0, conc_input:0},
                        { id: 8, time_input: 0, conc_input:0},
                        { id: 9, time_input: 0, conc_input:0},
                        { id: 10, time_input: 0, conc_input:0}
                         ]
                    },
                   {view: "toolbar", id:"toolbar", elements:[

                       {view:"button", value:"Compute", width:80 , click:"plotData()"},
                       {view:"button", value:"gatherData", width:80 , click:"getData()"},
                       ]
                   },
                   {rows:[
						{view:"form", id:"slider_input", height: 160,elements:[
							{ view:"slider",  height: 20, type:"alt", min:0, max:5, label:"N0(0-5)", value:"0", name:"s1"},
							{ view:"slider", height: 20, type:"alt", min:0, max:9, label:"NMax(0-9)", value:"0", name:"s2"},
							{ view:"slider", height: 20, type:"alt", min:0, max:5, label:"Rate(0-5)", value:"0", name:"s3"},
                            { view:"slider", height: 20, type:"alt",  label:"Time", value:"0", name:"s4"},
                            { view:"slider", height: 20, type:"alt",  label:"M", value:"0", name:"s5"},
						]},
						{view:"form", id:"insert_input", elements:[
							{
								type:"clean",
								cols:[
									{ view:"button", type: "form", id:"slider_set", label:"Set values", click:"set()",
                                        align:"right", width: 90,},
									{ view:"button", id:"slider_get", label:"Get values", click:"get()",
                                        align:"left", width: 90, }

								]
							},
							{ view: "fieldset", label:"Data", body:{
								//view:"form",
								rows:[
									{ view:"text", id: "nO", label:"N0", value:"0", name:"s1"},
									{ view:"text", id: "nmax", label:"NMax", value:"0", name:"s2"},
									{ view:"text", id: "rate", label:"Rate", value:"0", name:"s3"},
                                    { view:"text", id: "time", label:"Time", value:"0", name:"s4"},
                                    { view:"text", id: "m", label:"M", value:"0", name:"s5"},
								]
							}}
						]}
                   ]}
                ]},
               {rows:[
                    {view:"chart",
                    id: "data_chart",
                    type:"scatter",
                    scale: "logarithmic",
                    value:"#conc#",
                    xValue: "#time#",
                    origin: 0,
                    id: "plot",
                    yAxis:{
                        title:"Log Concentration of Bacteria",
                    },
                    xAxis:{
                        title:"Time (h)"
                    },
                    item:{
                        radius:5,
                        borderColor:"#f38f00",
                        borderWidth:1,
                        color:"#ff9600",
                        type:"d",
                        shadow:true
                    },
                    data: [
                        { time: 1, conc: 1},
                        { time: 1, conc: 1},
                        { time: 2, conc: 1.5},
                        { time: 3, conc: 2},
                        { time: 4, conc: 4},
                        { time: 5, conc: 5.5},
                        { time: 6, conc: 6},
                        { time: 7, conc: 6},

<<<<<<< HEAD
                    ],
=======
                    ]*/
                        //To be defined
                        //dataPoints
                        ,
>>>>>>> origin/master
               },
               {view: "datatable",
                id:"output_table",
                columns: [
                       {id: "export", header: "Export Data"},
                ],
                editable: false,

               }
               ]}

           ]}
        ]
    });

    function set(){
        var data = $$('insert_input').getValues();
        $$('slider_input').setValues(data);
    }

    function get(){
        var data = $$('slider_input').getValues();
        $$('insert_input').setValues(data);
    }

    function getCookie(name) {
        var cookieValue = null;
        if (document.cookie && document.cookie != '') {
            var cookies = document.cookie.split(';');
            for (var i = 0; i < cookies.length; i++) {
                var cookie = jQuery.trim(cookies[i]);
                // Does this cookie string begin with the name we want?
                if (cookie.substring(0, name.length + 1) == (name + '=')) {
                    cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                    break;
                }
            }
        }
        return cookieValue;

    }

    var csrftoken = getCookie('csrftoken');


    function computeData(){

        $.ajax({
            type: "POST",
            url: 'data/',
            dataType: "text",

            data: {
                /*
                csrfmiddlewaretoken: {{ csrf_token }},
                */
                nO: $('#nO').val(),
                nMax: $('#nmax').val(),
                rate: $('#rate').val(),
                time: $('#time').val(),
                m: $('#m').val(),

            }

        })
    //$$("data_chart").define
    }

    function getData() {
        //creates new array and pushes each value in the slider to the array
        //the array hold the data in the same order:
            //NO, NMax, Rate, Time, and M

        var data = [];
        data.push( $$('slider_input').getValues().s1); //NO
        data.push( $$('slider_input').getValues().s2); //NMax
        data.push( $$('slider_input').getValues().s3); //Rate
        data.push( $$('slider_input').getValues().s4); //Time
        data.push( $$('slider_input').getValues().s5); //M

        //prints out each value of the array on a separate page-----will be deleted later on as it is not necessary,
        // but works for now as specified
        for(var count=0; count<= data.length - 1; count++){
            document.writeln(data[count]);
        }
    }

    var dataPoints; //global data points to be used for plotting
    function plotData(){

        var time = [];
        var counter = 0;
         while($$('input_table').getLastId() > counter){
             time.push([$$('input_table').getIdByIndex(counter).time_input, $$('input_table').getIdByIndex(counter).conc_input]);
             counter++;
         }

        for(var r=0; r<time.size(); r++){
            for(var c=0; c<time[0].size(); c++){
                document.writeln(time[r][c]);
            }
        }
    }



    </script>
    </body>
</html>
